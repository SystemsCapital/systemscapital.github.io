<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>S&P 500 Price Statistics - Monthly | Q3 2025 | Systems Capital</title>

<meta name="description" content="Systems Capital publishes build-in-public investment research, Excel, SQL and Python financial tools, and educational content. S&P 500 Average Statistics - Monthly | Q3 2025 | Systems Capital." />

    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Canonical URL (update username if needed) -->
    <link rel="canonical" href="https://www.systemscapital.net/" />

    <!-- Favicon -->
    <link rel="icon" type="image/png" sizes="512x512" href="favicon.png">

    <!-- Open Graph (social + SEO bonus) -->
    <meta property="og:title" content="Systems Capital | Investment Research & Financial Tools">
    <meta property="og:description" content="Investment Research, Excel, SQL & Python Tools, and Educational Resources.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://www.systemscapital.net//">
    <meta property="og:image" content="hero.png">
<style>
/* ================= HEADER STYLES ================= */
body {
    background: white;
    font-family: 'Century Schoolbook', serif;
    margin: 0;
    padding: 0;
}

.header {
    display: flex;
    align-items: center;
    padding: 20px;
}

.logo-container {
    padding: 14px;
}

.flower-btn {
    background: none;
    border: none;
    cursor: pointer;
    padding: 8px;
}

.flower-btn:hover { opacity: 0.85; }

.flower {
    position: relative;
    width: 60px;
    height: 60px;
    transition: transform 0.2s ease;
    transform-origin: center center;
}

.flower:hover { transform: rotate(-45deg); }

.circle {
    width: 30px;
    height: 30px;
    border: 2px solid gray;
    border-radius: 50%;
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
}

.circle-0   { transform: translate(-50%, -50%) rotate(0deg) translate(0, -15px); }
.circle-45  { transform: translate(-50%, -50%) rotate(45deg) translate(0, -15px); }
.circle-90  { transform: translate(-50%, -50%) rotate(90deg) translate(0, -15px); }
.circle-135 { transform: translate(-50%, -50%) rotate(135deg) translate(0, -15px); }
.circle-180 { transform: translate(-50%, -50%) rotate(180deg) translate(0, -15px); }
.circle-225 { transform: translate(-50%, -50%) rotate(225deg) translate(0, -15px); }
.circle-270 { transform: translate(-50%, -50%) rotate(270deg) translate(0, -15px); }
.circle-315 { transform: translate(-50%, -50%) rotate(315deg) translate(0, -15px); }

nav {
    margin-left: 30px;
    font-size: 16px;
}

nav a {
    margin-right: 20px;
    text-decoration: none;
    color: #666;
}

nav a:hover { text-decoration: underline; }

/* ================= PAGE CONTENT ================= */
.content {
    max-width: 1200px;
    margin: 40px auto;
    padding: 0 20px;
    display: flex;
    flex-direction: column;
    align-items: stretch; /* stretch children, not centered */
    background: transparent; /* ensure background doesn’t block dropdowns */
}

h1 {
    color: #ABABAB;
    text-align: center;
    padding-top: 20px;
    font-size: 48px;
    margin: 0;
}

h2 {
    color: #ABABAB;
    text-align: center;
    padding: 20px 0;
    font-size: 22px;
    margin: 0;
}

/* BACK LINK */
.back-link {
    text-align: center;
    padding: 10px;
}

.back-link a {
    font-size: 20px;
    text-decoration: none;
    color: #555;
}

/* TABLE CONTAINER */
#csv-container { 
    width: 100%; /* full width */
    overflow-x: auto; 
    padding: 20px 0; /* keep some spacing */
}

/* TABLE */
table {
    border-collapse: collapse;
    width: 100%;
    min-width: 900px;
}

table,
table th,
table td {
    border: 1px solid #ABABAB;
}

table th,
table td {
    text-align: center;
    vertical-align: middle;
    padding: 8px 10px;
}


/* Alternating row colors */
table tbody tr:nth-child(odd) { background: #ffffff; }
table tbody tr:nth-child(even) { background: #f9f9f9; }

/* Hidden rows for filtering */
table tbody tr.hidden { visibility: collapse; }

/* DROPDOWN FILTER UI */
.filter-icon { margin-left: 5px; font-weight: bold; }
.dropdown-container { position: relative; }

.dropdown {
    display: none;
    position: absolute;
    top: 100%;
    left: 0;
    background: white;
    border: 1px solid #ABABAB;
    z-index: 9999; /* always above table */
    max-height: 250px;
    overflow-y: auto;
    min-width: 180px;
    padding: 5px;
}

.dropdown input[type="text"] { width: 90%; margin-bottom: 5px; }
.dropdown label { display: block; padding: 2px 5px; cursor: pointer; }
.dropdown label:hover { background-color: #f0f0f0; }
.dropdown label:nth-child(even) { background-color: #fafafa; }

.dropdown .buttons { position: sticky; bottom: 0; background: white; padding-top: 5px; }
.dropdown button { width: 48%; margin: 2px 1%; }

@media screen and (max-width: 768px) {
    table { width: 100%; }
    #csv-container { padding: 20px; }
}
</style>

<script>
let rotation = 0;
function handleLogoClick() {
    rotateFlower();
    setTimeout(() => { window.location.href = "/"; }, 200);
}
function rotateFlower() {
    rotation -= 45;
    document.getElementById("flower").style.transform = `rotate(${rotation}deg)`;
}
</script>
</head>

<body>

<!-- ================= HEADER ================= -->
<header class="header">
    <div class="logo-container">
        <button class="flower-btn" onclick="handleLogoClick()" aria-label="Systems Capital Home">
            <span class="flower" id="flower">
                <span class="circle circle-0"></span>
                <span class="circle circle-45"></span>
                <span class="circle circle-90"></span>
                <span class="circle circle-135"></span>
                <span class="circle circle-180"></span>
                <span class="circle circle-225"></span>
                <span class="circle circle-270"></span>
                <span class="circle circle-315"></span>
            </span>
        </button>
    </div>
    <nav>
        <a href="/">Home</a>
        <a href="/Pages/Tools.html">Tools</a>
    </nav>
</header>

<!-- ================= MAIN CONTENT ================= -->
<main class="content">

    <h1>S&P 500 Average Statistics | Monthly | Past 5 years | Published: Q3 2025</h1>
    <section>
<p>
This table presents detailed distribution statistics for each stock included in the S&P 500 index,
providing valuable insights into historical stock market performance. Using Python libraries such as Beautiful Soup 4
and Requests, we programmatically collected an up-to-date list of S&P 500 companies from Wikipedia. Monthly earnings
data spanning the past five years was then retrieved using Microsoft Excel’s STOCKHISTORY and LET functions. All
raw financial data is stored and managed in structured SQL databases for efficient querying and analysis. 
The information is provided on an “as-is” basis and reflects price-based calculations only; dividend data is not included.
</p>
</section>
    <div style="text-align:right; margin: 5px 0;">
    <button id="download-csv"
        style="
            font-size: 13px;
            padding: 4px 8px;
            border: 1px solid #ABABAB;
            background: white;
            cursor: pointer;
        ">
        Download CSV
    </button>
</div>


    <div id="csv-container">
        <table id="csv-table"></table>
    </div>
</main>

<footer>
    © Systems Capital Inc. · Investment Research · Financial Tools · Education
</footer>

<script>
const csvPath = 'data/SQL_Results.csv?version=' + new Date().getTime();

function formatDisplay(val, headerName) {
    const colName = headerName.toLowerCase();
    if (!isNaN(val) && val.trim() !== '' && !colName.includes('percentile')) {
        return (parseFloat(val) * 100).toFixed(2) + '%';
    }
    if (!isNaN(val) && colName.includes('percentile')) {
        return parseFloat(val).toFixed(2) + '%';
    }
    return val;
}

fetch(csvPath)
.then(res => res.text())
.then(text => {
    const rows = text.trim().split(/\r?\n/).map(r => r.split(','));
    const table = document.getElementById('csv-table');

    let header = '<thead><tr>';
    rows[0].forEach((col, idx) => {
        header += `
        <th data-col="${idx}" class="dropdown-container">
            ${col} <span class="filter-icon">&#x25BC;</span>
            <div class="dropdown">
                <div style="position:sticky; top:0"; background:white;>
                    <button class="select-all">Select All</button><button class="apply">Apply</button>
                    <input type="text" placeholder="Search"><button class="cancel">Cancel</button>
                </div>
                <div class="checkboxes">
                </div>
            </div>
        </th>`;
    });
    header += '</tr></thead>';

    let body = '<tbody>';
    for (let i = 1; i < rows.length; i++) {
        if (rows[i].length > 1) {
            body += '<tr>';
            rows[i].forEach((c, colIdx) => {
                const rawVal = c;
                const headerName = rows[0][colIdx];
                const displayVal = formatDisplay(rawVal, headerName);
                body += `<td data-value="${rawVal}">${displayVal}</td>`;
            });
            body += '</tr>';
        }
    }
    body += '</tbody>';

    table.innerHTML = header + body;

    const ths = table.querySelectorAll('th');
    const filters = Array(rows[0].length).fill(null);
    const sortState = Array(rows[0].length).fill(null);
    let lastSortedColumn = null;

    ths.forEach(th => {
        const idx = parseInt(th.dataset.col);
        const dropdown = th.querySelector('.dropdown');
        const checkboxContainer = th.querySelector('.checkboxes');
        const headerName = rows[0][idx];

        const unique = Array.from(new Set(rows.slice(1).map(r => r[idx]))).sort();
        unique.forEach(val => {
            const label = document.createElement('label');
            label.innerHTML = `<input type="checkbox" value="${val}" checked> ${formatDisplay(val, headerName)}`;
            checkboxContainer.appendChild(label);
        });

        checkboxContainer.insertAdjacentHTML('afterbegin', `
            <label><input type="radio" name="sort${idx}" value="asc"> Sort Asc</label>
            <label><input type="radio" name="sort${idx}" value="desc"> Sort Desc</label>
        `);

        th.addEventListener('click', e => {
            e.stopPropagation();
            document.querySelectorAll('.dropdown').forEach(d => { if (d !== dropdown) d.style.display = 'none'; });
            dropdown.style.display = dropdown.style.display === 'block' ? 'none' : 'block';
        });

        dropdown.addEventListener('click', e => e.stopPropagation());

        const searchInput = dropdown.querySelector('input[type=text]');
        searchInput.addEventListener('keyup', () => {
            const filterText = searchInput.value.toLowerCase();
            checkboxContainer.querySelectorAll('label').forEach(label => {
                const cb = label.querySelector('input[type=checkbox]');
                if (cb) {
                    const val = label.textContent.toLowerCase();
                    label.style.display = val.includes(filterText) ? 'block' : 'none';
                }
            });
        });

        dropdown.querySelector('.select-all').addEventListener('click', e => {
            e.stopPropagation();
            const checkboxes = checkboxContainer.querySelectorAll('input[type=checkbox]');
            const allChecked = Array.from(checkboxes).every(c => c.checked);
            checkboxes.forEach(c => c.checked = !allChecked);
        });

        dropdown.querySelector('.apply').addEventListener('click', () => {
            filters[idx] = Array.from(
                checkboxContainer.querySelectorAll('input[type=checkbox]:checked')
            ).map(c => c.value);

            const selectedSort = dropdown.querySelector(`input[name=sort${idx}]:checked`);
            sortState.fill(null);
            sortState[idx] = selectedSort ? selectedSort.value : null;
            lastSortedColumn = idx;

            applyFiltersAndSort();
            dropdown.style.display = 'none';
        });

        dropdown.querySelector('.cancel').addEventListener('click', () => {
            checkboxContainer.querySelectorAll('input[type=checkbox]').forEach(c => {
                c.checked = !filters[idx] || filters[idx].includes(c.value);
            });
            const radios = dropdown.querySelectorAll(`input[name=sort${idx}]`);
            radios.forEach(r => r.checked = sortState[idx] === r.value);
            dropdown.style.display = 'none';
        });
    });

    function applyFiltersAndSort() {
        const rowsArr = Array.from(table.tBodies[0].rows);

        /* ---------------- Apply Filters ---------------- */
        rowsArr.forEach(row => {
            let show = true;
            filters.forEach((vals, colIdx) => {
                if (vals) {
                    const cellVal = row.cells[colIdx].dataset.value;
                    if (!vals.includes(cellVal)) show = false;
                }
            });
            row.classList.toggle('hidden', !show); // <-- updated to keep row space
        });

        /* ---------------- Sort Visible Rows ---------------- */
        if (lastSortedColumn !== null) {
            const direction = sortState[lastSortedColumn];
            const ascending = direction === 'asc';
            const visible = rowsArr.filter(r => !r.classList.contains('hidden'));

            visible.sort((a, b) => {
                const aVal = a.cells[lastSortedColumn].dataset.value;
                const bVal = b.cells[lastSortedColumn].dataset.value;

                const aNum = parseFloat(aVal);
                const bNum = parseFloat(bVal);

                if (!isNaN(aNum) && !isNaN(bNum)) {
                    return ascending ? aNum - bNum : bNum - aNum;
                }
                return ascending ? aVal.localeCompare(bVal) : bVal.localeCompare(aVal);
            });

            visible.forEach(r => table.tBodies[0].appendChild(r));
        }
    }

    document.addEventListener('click', () => {
        document.querySelectorAll('.dropdown').forEach(d => d.style.display = 'none');
    });
})
.catch(err => {
    console.error(err);
    document.getElementById('csv-container').innerHTML =
        '<p style="color:red; text-align:center;">Failed to load CSV.</p>';
});
  
document.getElementById('download-csv').addEventListener('click', () => {
    const table = document.getElementById('csv-table');
    let csv = [];

    // Header row
    const headers = Array.from(table.querySelectorAll('thead th'))
        .map(th => `"${th.childNodes[0].textContent.trim()}"`);
    csv.push(headers.join(','));

    // Visible rows only
    const rows = Array.from(table.querySelectorAll('tbody tr'))
        .filter(r => !r.classList.contains('hidden'));

    rows.forEach(row => {
        const values = Array.from(row.cells).map(cell =>
            `"${cell.dataset.value.replace(/"/g, '""')}"`
        );
        csv.push(values.join(','));
    });

    const blob = new Blob([csv.join('\n')], { type: 'text/csv;charset=utf-8;' });
    const url = URL.createObjectURL(blob);

    const a = document.createElement('a');
    a.href = url;
    a.download = 'SP500 Stats_Q3-2025_SystemsCapital.csv';
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
});

</script>

</body>
</html>
