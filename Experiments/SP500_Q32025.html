<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>S&P 500 Price Statistics - Monthly | Q3 2025 | Systems Capital</title>

<meta name="description" content="Systems Capital publishes build-in-public investment research, Excel, SQL and Python financial tools, and educational content. S&P 500 Average Statistics - Monthly | Q3 2025 | Systems Capital." />
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="canonical" href="https://www.systemscapital.net/" />
<link rel="icon" type="image/png" sizes="512x512" href="favicon.png">

<meta property="og:title" content="Systems Capital | Investment Research & Financial Tools">
<meta property="og:description" content="Investment Research, Excel, SQL & Python Tools, and Educational Resources.">
<meta property="og:type" content="website">
<meta property="og:url" content="https://www.systemscapital.net/">
<meta property="og:image" content="hero.png">

<!-- ================== STYLES (UNCHANGED) ================== -->
<style>
body { background: white; font-family: 'Century Schoolbook', serif; margin:0; padding:0; }
.header { display:flex; align-items:center; padding:20px; }
.logo-container { padding:14px; }
.flower-btn { background:none; border:none; cursor:pointer; padding:8px; }
.flower-btn:hover { opacity:0.85; }
.flower { position:relative; width:60px; height:60px; transition: transform 0.2s ease; transform-origin:center center; }
.flower:hover { transform: rotate(-45deg); }
.circle { width:30px; height:30px; border:2px solid gray; border-radius:50%; position:absolute; top:50%; left:50%; transform:translate(-50%, -50%); }
.circle-0{transform:translate(-50%,-50%) rotate(0deg) translate(0,-15px);}
.circle-45{transform:translate(-50%,-50%) rotate(45deg) translate(0,-15px);}
.circle-90{transform:translate(-50%,-50%) rotate(90deg) translate(0,-15px);}
.circle-135{transform:translate(-50%,-50%) rotate(135deg) translate(0,-15px);}
.circle-180{transform:translate(-50%,-50%) rotate(180deg) translate(0,-15px);}
.circle-225{transform:translate(-50%,-50%) rotate(225deg) translate(0,-15px);}
.circle-270{transform:translate(-50%,-50%) rotate(270deg) translate(0,-15px);}
.circle-315{transform:translate(-50%,-50%) rotate(315deg) translate(0,-15px);}
nav{margin-left:30px;font-size:16px;}
nav a{margin-right:20px;text-decoration:none;color:#666;}
nav a:hover{text-decoration:underline;}

.content{max-width:1200px;margin:40px auto;padding:0 20px;display:flex;flex-direction:column;align-items:stretch;background:transparent;}
h1{color:#ABABAB;text-align:center;padding-top:20px;font-size:48px;margin:0;}
h2{color:#ABABAB;text-align:center;padding:20px 0;font-size:22px;margin:0;}

.back-link{text-align:center;padding:10px;}
.back-link a{font-size:20px;text-decoration:none;color:#555;}

#csv-container{width:100%;min-height:350px;overflow-x:auto;padding:20px 0;}
table{border-collapse:collapse;width:100%;min-width:900px;}
table, table th, table td{border:1px solid #ABABAB;}
table th, table td{text-align:center;vertical-align:middle;padding:8px 10px;}
th.active-dropdown{background-color:#ebebeb;color:#000;}
table tbody tr:nth-child(odd){background:#ffffff;}
table tbody tr:nth-child(even){background:#f9f9f9;}
table tbody tr.hidden{visibility:collapse;}

.filter-icon{margin-left:5px;font-weight:bold;}
.dropdown-container{position:relative;}
.dropdown{display:none;position:absolute;top:100%;left:0;background:white;border:1px solid #ABABAB;z-index:9999;max-height:250px;overflow-y:auto;min-width:180px;padding:5px;}
.dropdown input[type=text]{width:90%;margin-bottom:5px;}
.dropdown label{display:block;padding:2px 5px;cursor:pointer;}
.dropdown label:hover{background-color:#f0f0f0;}
.dropdown label:nth-child(even){background-color:#fafafa;}
.dropdown .buttons{position:sticky;bottom:0;background:white;padding-top:5px;}
.dropdown button{width:48%;margin:2px 1%;}

@media screen and (max-width:768px){table{width:100%;} #csv-container{padding:20px;}}
</style>

<script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
<script>
let rotation = 0;
function handleLogoClick() { rotateFlower(); setTimeout(()=>{window.location.href="/";},200);}
function rotateFlower(){rotation-=45; document.getElementById("flower").style.transform=`rotate(${rotation}deg)`;}
</script>
</head>
<body>

<header class="header">
    <div class="logo-container">
        <button class="flower-btn" onclick="handleLogoClick()" aria-label="Systems Capital Home">
            <span class="flower" id="flower">
                <span class="circle circle-0"></span>
                <span class="circle circle-45"></span>
                <span class="circle circle-90"></span>
                <span class="circle circle-135"></span>
                <span class="circle circle-180"></span>
                <span class="circle circle-225"></span>
                <span class="circle circle-270"></span>
                <span class="circle circle-315"></span>
            </span>
        </button>
    </div>
    <nav><a href="/">Home</a></nav>
</header>

<main class="content">
<h1>S&P 500 Average Statistics | Monthly | Past 5 years | Published: Q3 2025</h1>
<section>
<p>This table presents detailed distribution statistics for each stock included in the S&P 500 index,
providing valuable insights into historical stock market performance. Using Python libraries such as Beautiful Soup 4
and Requests, we programmatically collected an up-to-date list of S&P 500 companies from Wikipedia. Monthly earnings
data spanning the past five years was then retrieved using Microsoft Excel STOCKHISTORY and LET functions. All
raw financial data is stored and managed in structured SQL databases for efficient querying and analysis. 
The information is provided on an “as-is” basis and reflects price-based calculations only; dividend data is not included.</p>
</section>

<div style="text-align:right; margin:5px 0;">
  <a href="https://buy.stripe.com/test_4gM5kDae6eq82ADeuk8g000" target="_blank" style="font-size:13px; padding:4px 8px; border:1px solid #ABABAB; background:white; cursor:pointer; text-decoration:none; color:black;">
    Subscribe to Download
  </a>
</div>


<div id="csv-container">
    <table id="csv-table"></table>
</div>
</main>

<footer>
© Systems Capital Inc. · Investment Research · Financial Tools · Education
</footer>

<script>
const csvPath = 'data/SQL_Results.csv?version=' + new Date().getTime();

function formatDisplay(val, headerName){
    const colName = headerName.toLowerCase();
    if(!isNaN(val) && val.trim()!=='' && !colName.includes('percentile')) return (parseFloat(val)*100).toFixed(2)+'%';
    if(!isNaN(val) && colName.includes('percentile')) return parseFloat(val).toFixed(2)+'%';
    return val;
}

// ---------- Load CSV ----------
Papa.parse(csvPath,{
    download:true,
    header:true,
    skipEmptyLines:true,
    complete:function(results){
        const rows = results.data;
        const table = document.getElementById('csv-table');

        // --- Header ---
        let header='<thead><tr>';
        const headers = Object.keys(rows[0]).filter(c=>c!=='Company');
        headers.forEach((col, idx)=>{
            header+=`
            <th data-col="${idx}" class="dropdown-container">
                ${col} <span class="filter-icon">&#x25BC;</span>
                <div class="dropdown">
                    <div style="position:sticky; top:0; background:white;">
                        <button class="select-all">Select All</button>
                        <button class="apply">Apply</button>
                        <input type="text" placeholder="Search">
                    </div>
                    <div class="checkboxes"></div>
                </div>
            </th>`;
        });
        header+='</tr></thead>';

        // --- Body ---
        let body='<tbody>';
        rows.forEach(row=>{
            body+='<tr>';
            headers.forEach(col=>{
                let titleAttr='';
                if(col==='Symbol') titleAttr=` title="${row.Company}"`;
                const rawVal = row[col];
                const displayVal = formatDisplay(rawVal, col);
                body+=`<td data-value="${rawVal}"${titleAttr}>${displayVal}</td>`;
            });
            body+='</tr>';
        });
        body+='</tbody>';
        table.innerHTML = header + body;

        // --- Filters & Sort ---
        const ths = table.querySelectorAll('th');
        const filters = Array(headers.length).fill(null);
        const sortState = Array(headers.length).fill(null);
        let lastSortedColumn = null;

        ths.forEach((th, idx)=>{
            const dropdown = th.querySelector('.dropdown');
            const checkboxContainer = th.querySelector('.checkboxes');

            // Unique values for filter checkboxes
            const colValues = Array.from(table.querySelectorAll(`tbody tr td:nth-child(${idx+1})`))
                                .map(td=>td.dataset.value);
            [...new Set(colValues)].sort((a,b)=>{
                const aNum = parseFloat(a);
                const bNum = parseFloat(b);
                if(!isNaN(aNum) && !isNaN(bNum)) return aNum-bNum;
                return a.localeCompare(b);
            }).forEach(val=>{
                const label = document.createElement('label');
                label.innerHTML = `<input type="checkbox" value="${val}" checked> ${formatDisplay(val, headers[idx])}`;
                checkboxContainer.appendChild(label);
            });

            // Sort radio buttons
            checkboxContainer.insertAdjacentHTML('afterbegin', `
                <label><input type="radio" name="sort${idx}" value="asc"> Sort Asc</label>
                <label><input type="radio" name="sort${idx}" value="desc"> Sort Desc</label>
            `);

            // Toggle dropdown
            th.addEventListener('click', e=>{
                e.stopPropagation();
                document.querySelectorAll('.dropdown').forEach(d=>{
                    if(d!==dropdown){ d.style.display='none'; d.closest('th').classList.remove('active-dropdown'); }
                });
                const visible = dropdown.style.display==='block';
                dropdown.style.display = visible ? 'none' : 'block';
                th.classList.toggle('active-dropdown', !visible);
            });
            dropdown.addEventListener('click', e=>e.stopPropagation());

            // Search filter inside dropdown
            const searchInput = dropdown.querySelector('input[type=text]');
            searchInput.addEventListener('keyup', ()=>{
                const filterText = searchInput.value.toLowerCase();
                checkboxContainer.querySelectorAll('label').forEach(label=>{
                    label.style.display = label.textContent.toLowerCase().includes(filterText) ? 'block' : 'none';
                });
            });

            // Select All button
            dropdown.querySelector('.select-all').addEventListener('click', e=>{
                e.stopPropagation();
                const boxes = checkboxContainer.querySelectorAll('input[type=checkbox]');
                const allChecked = Array.from(boxes).every(c=>c.checked);
                boxes.forEach(c=>c.checked = !allChecked);
            });

            // Apply button
            dropdown.querySelector('.apply').addEventListener('click', ()=>{
                filters[idx] = Array.from(checkboxContainer.querySelectorAll('input[type=checkbox]:checked')).map(c=>c.value);
                const selectedSort = dropdown.querySelector(`input[name=sort${idx}]:checked`);
                sortState.fill(null);
                sortState[idx] = selectedSort ? selectedSort.value : null;
                lastSortedColumn = idx;
                applyFiltersAndSort();
                dropdown.style.display='none';
                th.classList.remove('active-dropdown');
            });
        });

        // ---------- Apply Filters and Sort ----------
        function applyFiltersAndSort(){
            const rowsArr = Array.from(table.tBodies[0].rows);

            // Apply filters
            rowsArr.forEach(row=>{
                let show=true;
                filters.forEach((vals,colIdx)=>{
                    if(vals){
                        const cellVal=row.cells[colIdx].dataset.value;
                        if(!vals.includes(cellVal)) show=false;
                    }
                });
                row.classList.toggle('hidden', !show);
            });

            // Apply sorting
            if(lastSortedColumn!==null){
                const ascending = sortState[lastSortedColumn]==='asc';
                const visible = rowsArr.filter(r=>!r.classList.contains('hidden'));
                visible.sort((a,b)=>{
                    const aVal=parseFloat(a.cells[lastSortedColumn].dataset.value);
                    const bVal=parseFloat(b.cells[lastSortedColumn].dataset.value);
                    if(!isNaN(aVal) && !isNaN(bVal)) return ascending ? aVal-bVal : bVal-aVal;
                    return ascending ? a.cells[lastSortedColumn].dataset.value.localeCompare(b.cells[lastSortedColumn].dataset.value)
                                     : b.cells[lastSortedColumn].dataset.value.localeCompare(a.cells[lastSortedColumn].dataset.value);
                });
                visible.forEach(r=>table.tBodies[0].appendChild(r));
            }
        }

        // Close dropdowns when clicking outside
        document.addEventListener('click', ()=>{
            ths.forEach(th=>{
                const dropdown = th.querySelector('.dropdown');
                if(dropdown.style.display==='block'){ dropdown.style.display='none'; th.classList.remove('active-dropdown'); }
            });
        });
    },
    error:function(err){
        console.error(err);
        document.getElementById('csv-container').innerHTML='<p style="color:red;text-align:center;">Failed to load CSV.</p>';
    }
});

// ---------- CSV DOWNLOAD ----------
document.getElementById('download-csv').addEventListener('click', ()=>{
    const table=document.getElementById('csv-table');
    const headers=Array.from(table.querySelectorAll('thead th')).map(th=>`"${th.textContent.trim()}"`);
    let csv=[headers.join(',')];
    const rows=Array.from(table.querySelectorAll('tbody tr')).filter(r=>!r.classList.contains('hidden'));
    rows.forEach(row=>{
        const vals=Array.from(row.cells).map(c=>`"${c.dataset.value.replace(/"/g,'""')}"`);
        csv.push(vals.join(','));
    });
    const blob=new Blob([csv.join('\n')],{type:'text/csv;charset=utf-8;'});
    const url=URL.createObjectURL(blob);
    const a=document.createElement('a'); a.href=url; a.download='SP500_Stats_Q3-2025_SystemsCapital.csv';
    document.body.appendChild(a); a.click(); document.body.removeChild(a); URL.revokeObjectURL(url);
});
</script>


</body>
</html>
